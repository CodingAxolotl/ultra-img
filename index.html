<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Creeper AI Image Generator</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
    margin: 0;
    font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
    background: radial-gradient(circle at top, #0f172a, #020617);
    color: white;
    display: flex;
    justify-content: center;
    min-height: 100vh;
}

.app {
    width: 100%;
    max-width: 900px;
    padding: 24px;
}

h1 {
    font-size: 2.3rem;
    margin-bottom: 6px;
    background: linear-gradient(135deg, #22c55e, #4ade80);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
}

p {
    opacity: 0.8;
    margin-top: 0;
}

textarea {
    width: 100%;
    min-height: 80px;
    padding: 12px;
    font-size: 1rem;
    border-radius: 12px;
    border: none;
    outline: none;
    resize: vertical;
    margin-top: 14px;
}

.controls {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
    gap: 12px;
    margin-top: 14px;
}

.control {
    display: flex;
    flex-direction: column;
    font-size: 0.85rem;
    opacity: 0.9;
}

.control input {
    margin-top: 4px;
    padding: 8px;
    border-radius: 8px;
    border: none;
    outline: none;
}

.checkbox {
    flex-direction: row;
    align-items: center;
    gap: 8px;
    margin-top: 22px;
}

button {
    width: 100%;
    margin-top: 18px;
    padding: 14px;
    font-size: 1.1rem;
    font-weight: 600;
    border-radius: 12px;
    border: none;
    cursor: pointer;
    background: linear-gradient(135deg, #22c55e, #16a34a);
    color: black;
}

button:disabled {
    opacity: 0.6;
    cursor: not-allowed;
}

.status {
    margin-top: 14px;
    font-size: 0.95rem;
    opacity: 0.85;
}

.output {
    display: flex;
    justify-content: center;
    margin-top: 20px;
}

img {
    width: 75vw;
    max-width: 720px;
    border-radius: 14px;
    display: none;
}

.seed {
    margin-top: 8px;
    font-size: 0.9rem;
    opacity: 0.7;
    text-align: center;
}

footer {
    margin-top: 32px;
    text-align: center;
    font-size: 0.85rem;
    opacity: 0.6;
}
</style>
</head>

<body>
<div class="app">
    <h1>üé® Creeper AI Image Generator</h1>
    <p>Ultra-fast image generation powered by Z-Image-Turbo</p>

    <textarea id="prompt" placeholder="Describe the image you want to generate..."></textarea>

    <div class="controls">
        <div class="control">
            <label>Width</label>
            <input id="width" type="number" value="1024" min="512" max="2048" step="64">
        </div>

        <div class="control">
            <label>Height</label>
            <input id="height" type="number" value="1024" min="512" max="2048" step="64">
        </div>

        <div class="control">
            <label>Steps</label>
            <input id="steps" type="number" value="9" min="1" max="20">
        </div>

        <div class="control">
            <label>Seed</label>
            <input id="seedInput" type="number" value="42">
        </div>

        <div class="control checkbox">
            <input id="randomSeed" type="checkbox" checked>
            <label>Random seed</label>
        </div>
    </div>

    <button id="generateBtn">üöÄ Generate Image</button>

    <div id="status" class="status"></div>

    <div class="output">
        <img id="resultImage" alt="Generated image">
    </div>

    <div id="seedUsed" class="seed"></div>

    <footer>
        Powered by Z-Image-Turbo ‚Ä¢ Free API via Hugging Face Spaces
    </footer>
</div>

<script type="module">
import { Client } from "./gradio.js";

const btn = document.getElementById("generateBtn");
const status = document.getElementById("status");
const img = document.getElementById("resultImage");
const seedUsedText = document.getElementById("seedUsed");

let client = null;

async function connect() {
    if (!client) {
        status.textContent = "Connecting to GPU‚Ä¶";
        client = await Client.connect("mrfakename/Z-Image-Turbo");
    }
    return client;
}

btn.onclick = async () => {
    const prompt = document.getElementById("prompt").value.trim();
    if (!prompt) {
        status.textContent = "Please enter a prompt.";
        return;
    }

    btn.disabled = true;
    img.style.display = "none";
    seedUsedText.textContent = "";
    status.textContent = "Generating image‚Ä¶ GPU working ‚ö°";

    try {
        const api = await connect();

        const result = await api.predict("/generate_image", {
            prompt: prompt,
            width: Number(document.getElementById("width").value),
            height: Number(document.getElementById("height").value),
            num_inference_steps: Number(document.getElementById("steps").value),
            seed: Number(document.getElementById("seedInput").value),
            randomize_seed: document.getElementById("randomSeed").checked
        });

        const imageData = result.data[0];
        const imageUrl = typeof imageData === "string" ? imageData : imageData.url;

        img.src = imageUrl + "?t=" + Date.now();
        img.style.display = "block";
        seedUsedText.textContent = "Seed used: " + result.data[1];
        status.textContent = "Done ‚úÖ";

    } catch (e) {
        console.error(e);
        status.textContent = "‚ùå Failed to generate image";
    }

    btn.disabled = false;
};
</script>
</body>
</html>
